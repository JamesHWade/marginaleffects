---
title: "S Values"
---

```{r, include = FALSE}
options(width = 1000)
## this vignette is in .Rbuildignore because lme4 is not available on old CRAN
## test machines.

knitr::opts_chunk$set(
  collapse = TRUE,
  fig.width = 9,
  fig.asp = .4,
  out.width = "100%",
  warning = FALSE,
  message = FALSE,
  comment = "#>"
)
```

@RafGre2020 discuss the _S_-value (a.k.a. "Shannon transform" or "binary surprisal value"). _S_ is cognitive tool to help analysts make sense of p values. Our goal is to transform a p value into the probability of an outcome for a familiar game of chance.

Consider this situation: We toss a coin 4 times and see if we can reject the null hypothesis that the coin is fair. If the null is true, then the probability of getting "Heads" is $\frac{1}{2}$. The probability of observing 4 straight heads is $\left (\frac{1}{2} \right )^4=\frac{1}{16}=0.0625$.

This probability (0.0625) characterizes the "surprise" caused by observing 4 straight heads in a world where the null holds, that is, where the coin is fair.

Now consider a different perspective. We first estimate a model, then conduct a hypothesis test to see if two coefficients are equal:

```{r}
library(marginaleffects)
mod <- lm(mpg ~ factor(cyl), mtcars)
hyp <- hypotheses(mod, "`factor(cyl)6` = `factor(cyl)8`")
hyp
```

The difference between our two coefficients is `r sprintf("%.2f", hyp$estimate)`, and the associated p value is `r hyp$p.value`. Again, the p value can be interpreted as a measure of the surprise that would be generated by the data, given that the null hypothesis is true (i.e., the two coefficients are equal).

How many consecutive *Heads* would I need to get to be as surprised as I am by this test. To answer this, we must solve the equation $p=\left (\frac{1}{2} \right )^s$. The solution to this equation is the negative log base two:

```{r}
#| include: false
attr(hyp$p.value, "label") <- attr(hyp$p.value, "jacobian") <- NULL
```
```{r}
-log2(hyp$p.value)
```

Indeed, the probability of throwing 9 straight *Heads* with a fair coin is $0.5^2=`r .5^9`$, which is very close to the p value that we observed in the test above.

If the two coefficients were equal, finding a difference as big as `r sprintf("%.2f", hyp$estimate)` would be as surprising as tossing 9 straight *Heads* on a fair coin.


